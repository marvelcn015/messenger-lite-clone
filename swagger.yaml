openapi: 3.0.3
info:
  title: Messenger Lite Clone API
  description: |
    # è¼•é‡ç‰ˆå³æ™‚é€šè¨Šæ‡‰ç”¨ç¨‹å¼ API è¦æ ¼æ–‡ä»¶

    æœ¬æ–‡ä»¶æä¾›å®Œæ•´çš„ API è¦æ ¼èªªæ˜ï¼ŒåŒ…å«ç³»çµ±æ¶æ§‹è¨­è¨ˆã€è³‡æ–™åº«çµæ§‹èˆ‡ API ç«¯é»è©³ç´°èªªæ˜ã€‚

    ## ğŸ—ï¸ ç³»çµ±æ¶æ§‹æ¦‚è¦½

    ç³»çµ±æ¡ç”¨å¾®æœå‹™æ¶æ§‹ï¼ŒåŒ…å«ä»¥ä¸‹ä¸»è¦çµ„ä»¶ï¼š

    - **å®¢æˆ¶ç«¯å±¤**: æ”¯æ´ç§»å‹•æ‡‰ç”¨ç¨‹å¼ã€ç¶²é æ‡‰ç”¨ç¨‹å¼ã€æ¡Œé¢æ‡‰ç”¨ç¨‹å¼
    - **API é–˜é“**: è² è¼‰å‡è¡¡èˆ‡ API è·¯ç”±
    - **æ‡‰ç”¨æœå‹™å±¤**: Express.js API æœå‹™èˆ‡å³æ™‚é€šè¨Šæœå‹™
    - **è³‡æ–™å±¤**: PostgreSQLã€MongoDBã€Redis å¤šé‡è³‡æ–™å„²å­˜
    - **å¤–éƒ¨æœå‹™**: æª”æ¡ˆå„²å­˜ã€æ¨æ’­é€šçŸ¥ã€ç¬¬ä¸‰æ–¹æ•´åˆæœå‹™
    - **ç›£æ§å±¤**: æ—¥èªŒç³»çµ±ã€æ•ˆèƒ½ç›£æ§ã€æ‡‰ç”¨ç¨‹å¼ç›£æ§

    ## ğŸ“‹ åŠŸèƒ½æ¨¡çµ„

    ç³»çµ±åŸºæ–¼ BDD (è¡Œç‚ºé©…å‹•é–‹ç™¼) è¨­è¨ˆï¼ŒåŒ…å«ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„ï¼š

    1. **ğŸ” ä½¿ç”¨è€…ç®¡ç†**: è¨»å†Šã€ç™»å…¥ã€å€‹äººè³‡æ–™ç®¡ç†
    2. **ğŸ‘¥ å¥½å‹ç®¡ç†**: æœå°‹ã€é‚€è«‹ã€åˆ†çµ„ç®¡ç†
    3. **ğŸ’¬ å³æ™‚è¨Šæ¯**: å¤šåª’é«”è¨Šæ¯ã€ç‹€æ…‹è¿½è¹¤
    4. **ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ç¾¤çµ„èŠå¤©**: ç¾¤çµ„ç®¡ç†ã€æ¬Šé™æ§åˆ¶
    5. **ğŸ”” é€šçŸ¥ç³»çµ±**: æ¨æ’­é€šçŸ¥ã€å‹¿æ‰“æ“¾è¨­å®š
    6. **ğŸ”’ ç‹€æ…‹éš±ç§**: ç·šä¸Šç‹€æ…‹ã€éš±ç§æ§åˆ¶
    7. **ğŸ“ æª”æ¡ˆä¸Šå‚³**: åœ–ç‰‡ã€æª”æ¡ˆã€èªéŸ³è™•ç†

    ## ğŸ¯ è¨­è¨ˆåŸå‰‡

    - **RESTful API**: éµå¾ª REST è¨­è¨ˆåŸå‰‡
    - **JWT èªè­‰**: ç„¡ç‹€æ…‹èº«ä»½é©—è­‰
    - **å¤šèªè¨€æ”¯æ´**: å®Œæ•´ç¹é«”ä¸­æ–‡æ”¯æ´
    - **é«˜å¯ç”¨æ€§**: æ”¯æ´æ°´å¹³æ“´å±•èˆ‡æ•…éšœè½‰ç§»
    - **å®‰å…¨ç¬¬ä¸€**: å¤šå±¤å®‰å…¨é˜²è­·æ©Ÿåˆ¶
  version: 1.0.0
  contact:
    name: Messenger Lite Clone Team
    email: support@messenger-lite.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: https://api.messenger-lite.com/v1
    description: æ­£å¼ç’°å¢ƒä¼ºæœå™¨
  - url: https://staging-api.messenger-lite.com/v1
    description: æ¸¬è©¦ç’°å¢ƒä¼ºæœå™¨
  - url: http://localhost:3000/api/v1
    description: æœ¬åœ°é–‹ç™¼ä¼ºæœå™¨

security:
  - BearerAuth: []

tags:
  - name: ä½¿ç”¨è€…ç®¡ç†
    description: ä½¿ç”¨è€…è¨»å†Šã€ç™»å…¥ã€å€‹äººè³‡æ–™ç®¡ç†ç›¸é—œ API
  - name: å¥½å‹ç®¡ç†
    description: å¥½å‹æœå°‹ã€é‚€è«‹ã€ç®¡ç†ç›¸é—œ API
  - name: å³æ™‚è¨Šæ¯
    description: ä¸€å°ä¸€è¨Šæ¯å‚³é€ã€ç·¨è¼¯ã€åˆªé™¤ç›¸é—œ API
  - name: ç¾¤çµ„èŠå¤©
    description: ç¾¤çµ„å»ºç«‹ã€ç®¡ç†ã€ç¾¤çµ„è¨Šæ¯ç›¸é—œ API
  - name: é€šçŸ¥ç³»çµ±
    description: æ¨æ’­é€šçŸ¥ã€é€šçŸ¥è¨­å®šç›¸é—œ API
  - name: ç·šä¸Šç‹€æ…‹èˆ‡éš±ç§
    description: ä½¿ç”¨è€…ç‹€æ…‹ç®¡ç†ã€éš±ç§è¨­å®šç›¸é—œ API
  - name: æª”æ¡ˆä¸Šå‚³
    description: åœ–ç‰‡ã€æª”æ¡ˆã€èªéŸ³è¨Šæ¯ä¸Šå‚³ç›¸é—œ API

paths:
  # ==================== ä½¿ç”¨è€…ç®¡ç† ====================
  /auth/register:
    post:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: ä½¿ç”¨è€…è¨»å†Š
      description: è¨»å†Šæ–°çš„ä½¿ç”¨è€…å¸³è™Ÿï¼Œéœ€è¦æä¾›åŸºæœ¬è³‡æ–™ä¸¦é€²è¡Œé›»å­éƒµä»¶èˆ‡æ‰‹æ©Ÿè™Ÿç¢¼é©—è­‰
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - password
                - phoneNumber
              properties:
                username:
                  type: string
                  description: ä½¿ç”¨è€…åç¨±ï¼ˆé¡¯ç¤ºåç¨±ï¼‰
                  minLength: 2
                  maxLength: 50
                  example: "john_doe"
                email:
                  type: string
                  format: email
                  description: é›»å­éƒµä»¶åœ°å€
                  example: "john@example.com"
                password:
                  type: string
                  description: å¯†ç¢¼ï¼ˆè‡³å°‘8å­—å…ƒï¼ŒåŒ…å«è‹±æ•¸å­—ï¼‰
                  minLength: 8
                  pattern: "^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d@$!%*#?&]{8,}$"
                  example: "SecurePass123"
                phoneNumber:
                  type: string
                  description: æ‰‹æ©Ÿè™Ÿç¢¼ï¼ˆåœ‹éš›æ ¼å¼ï¼‰
                  pattern: "^\\+[1-9]\\d{1,14}$"
                  example: "+1234567890"
                profilePicture:
                  type: string
                  format: binary
                  description: å¤§é ­ç…§ï¼ˆé¸å¡«ï¼‰
                acceptTerms:
                  type: boolean
                  description: åŒæ„æœå‹™æ¢æ¬¾èˆ‡éš±ç§æ”¿ç­–
                  example: true
      responses:
        '201':
          description: è¨»å†ŠæˆåŠŸï¼Œéœ€è¦é€²è¡Œé›»å­éƒµä»¶èˆ‡æ‰‹æ©Ÿé©—è­‰
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "è¨»å†ŠæˆåŠŸï¼Œè«‹æª¢æŸ¥æ‚¨çš„é›»å­éƒµä»¶èˆ‡æ‰‹æ©Ÿç°¡è¨Šä»¥å®Œæˆé©—è­‰"
                  userId:
                    type: string
                    example: "user_12345"
                  verificationRequired:
                    type: object
                    properties:
                      email:
                        type: boolean
                        example: true
                      phone:
                        type: boolean
                        example: true
        '400':
          description: è¨»å†Šè³‡æ–™ä¸ç¬¦åˆè¦æ±‚
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '409':
          description: é›»å­éƒµä»¶æˆ–æ‰‹æ©Ÿè™Ÿç¢¼å·²è¢«è¨»å†Š
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/login:
    post:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: ä½¿ç”¨è€…ç™»å…¥
      description: ä½¿ç”¨é›»å­éƒµä»¶æˆ–æ‰‹æ©Ÿè™Ÿç¢¼ç™»å…¥ç³»çµ±
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - identifier
                - password
              properties:
                identifier:
                  type: string
                  description: é›»å­éƒµä»¶æˆ–æ‰‹æ©Ÿè™Ÿç¢¼
                  example: "john@example.com"
                password:
                  type: string
                  description: å¯†ç¢¼
                  example: "SecurePass123"
                deviceInfo:
                  type: object
                  description: è£ç½®è³‡è¨Šï¼ˆç”¨æ–¼æ¨æ’­é€šçŸ¥ï¼‰
                  properties:
                    deviceType:
                      type: string
                      enum: [mobile, desktop, web]
                      example: "mobile"
                    deviceToken:
                      type: string
                      description: æ¨æ’­é€šçŸ¥ token
                      example: "fcm_token_123"
      responses:
        '200':
          description: ç™»å…¥æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "ç™»å…¥æˆåŠŸ"
                  accessToken:
                    type: string
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                  refreshToken:
                    type: string
                    example: "refresh_token_123"
                  user:
                    $ref: '#/components/schemas/UserProfile'
        '401':
          description: ç™»å…¥å¤±æ•—
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '423':
          description: å¸³è™Ÿè¢«åœç”¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/logout:
    post:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: ä½¿ç”¨è€…ç™»å‡º
      description: ç™»å‡ºç³»çµ±ä¸¦æ¸…é™¤ç™»å…¥ç‹€æ…‹
      responses:
        '200':
          description: ç™»å‡ºæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "ç™»å‡ºæˆåŠŸ"

  /auth/verify/email:
    post:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: é›»å­éƒµä»¶é©—è­‰
      description: é©—è­‰ä½¿ç”¨è€…çš„é›»å­éƒµä»¶åœ°å€
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - verificationCode
              properties:
                userId:
                  type: string
                  description: ä½¿ç”¨è€… ID
                  example: "user_12345"
                verificationCode:
                  type: string
                  description: 6ä½æ•¸é©—è­‰ç¢¼
                  pattern: "^\\d{6}$"
                  example: "123456"
      responses:
        '200':
          description: é›»å­éƒµä»¶é©—è­‰æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "é›»å­éƒµä»¶é©—è­‰æˆåŠŸ"

  /auth/verify/phone:
    post:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: æ‰‹æ©Ÿè™Ÿç¢¼é©—è­‰
      description: é©—è­‰ä½¿ç”¨è€…çš„æ‰‹æ©Ÿè™Ÿç¢¼
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - verificationCode
              properties:
                userId:
                  type: string
                  description: ä½¿ç”¨è€… ID
                  example: "user_12345"
                verificationCode:
                  type: string
                  description: 6ä½æ•¸é©—è­‰ç¢¼
                  pattern: "^\\d{6}$"
                  example: "654321"
      responses:
        '200':
          description: æ‰‹æ©Ÿè™Ÿç¢¼é©—è­‰æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "æ‰‹æ©Ÿè™Ÿç¢¼é©—è­‰æˆåŠŸ"

  /profile:
    get:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: å–å¾—å€‹äººè³‡æ–™
      description: å–å¾—ç›®å‰ç™»å…¥ä½¿ç”¨è€…çš„å€‹äººè³‡æ–™
      responses:
        '200':
          description: æˆåŠŸå–å¾—å€‹äººè³‡æ–™
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserProfile'

    put:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: æ›´æ–°å€‹äººè³‡æ–™
      description: æ›´æ–°ä½¿ç”¨è€…çš„å€‹äººè³‡æ–™
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                displayName:
                  type: string
                  description: é¡¯ç¤ºåç¨±
                  minLength: 2
                  maxLength: 50
                  example: "John Updated"
                statusMessage:
                  type: string
                  description: å€‹äººç‹€æ…‹è¨Šæ¯
                  maxLength: 200
                  example: "Busy at work"
                privacySettings:
                  $ref: '#/components/schemas/PrivacySettings'
      responses:
        '200':
          description: å€‹äººè³‡æ–™æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å€‹äººè³‡æ–™æ›´æ–°æˆåŠŸ"
                  user:
                    $ref: '#/components/schemas/UserProfile'

  /profile/avatar:
    post:
      tags:
        - ä½¿ç”¨è€…ç®¡ç†
      summary: ä¸Šå‚³å¤§é ­ç…§
      description: ä¸Šå‚³ä¸¦æ›´æ–°ä½¿ç”¨è€…çš„å¤§é ­ç…§
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - avatar
              properties:
                avatar:
                  type: string
                  format: binary
                  description: å¤§é ­ç…§æª”æ¡ˆï¼ˆJPG, PNG, æœ€å¤§ 5MBï¼‰
      responses:
        '200':
          description: å¤§é ­ç…§ä¸Šå‚³æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å¤§é ­ç…§æ›´æ–°æˆåŠŸ"
                  avatarUrl:
                    type: string
                    example: "https://cdn.messenger-lite.com/avatars/user_12345.jpg"

  # ==================== å¥½å‹ç®¡ç† ====================
  /friends/search:
    get:
      tags:
        - å¥½å‹ç®¡ç†
      summary: æœå°‹ä½¿ç”¨è€…
      description: é€éé›»å­éƒµä»¶ã€æ‰‹æ©Ÿè™Ÿç¢¼æˆ–ä½¿ç”¨è€…åç¨±æœå°‹å…¶ä»–ä½¿ç”¨è€…
      parameters:
        - name: q
          in: query
          required: true
          schema:
            type: string
          description: æœå°‹é—œéµå­—ï¼ˆé›»å­éƒµä»¶ã€æ‰‹æ©Ÿè™Ÿç¢¼æˆ–ä½¿ç”¨è€…åç¨±ï¼‰
          example: "jane@example.com"
        - name: type
          in: query
          schema:
            type: string
            enum: [email, phone, username, all]
            default: all
          description: æœå°‹é¡å‹
      responses:
        '200':
          description: æœå°‹çµæœ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  results:
                    type: array
                    items:
                      $ref: '#/components/schemas/UserSearchResult'

  /friends/requests:
    get:
      tags:
        - å¥½å‹ç®¡ç†
      summary: å–å¾—å¥½å‹é‚€è«‹åˆ—è¡¨
      description: å–å¾—æ”¶åˆ°å’Œç™¼é€çš„å¥½å‹é‚€è«‹åˆ—è¡¨
      parameters:
        - name: type
          in: query
          schema:
            type: string
            enum: [received, sent, all]
            default: all
          description: é‚€è«‹é¡å‹
      responses:
        '200':
          description: å¥½å‹é‚€è«‹åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  received:
                    type: array
                    items:
                      $ref: '#/components/schemas/FriendRequest'
                  sent:
                    type: array
                    items:
                      $ref: '#/components/schemas/FriendRequest'

    post:
      tags:
        - å¥½å‹ç®¡ç†
      summary: ç™¼é€å¥½å‹é‚€è«‹
      description: å‘æŒ‡å®šä½¿ç”¨è€…ç™¼é€å¥½å‹é‚€è«‹
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - targetUserId
              properties:
                targetUserId:
                  type: string
                  description: ç›®æ¨™ä½¿ç”¨è€… ID
                  example: "user_67890"
                message:
                  type: string
                  description: é‚€è«‹è¨Šæ¯ï¼ˆé¸å¡«ï¼‰
                  maxLength: 200
                  example: "Hi, let's be friends!"
      responses:
        '201':
          description: å¥½å‹é‚€è«‹ç™¼é€æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å¥½å‹é‚€è«‹å·²ç™¼é€"
                  requestId:
                    type: string
                    example: "request_123"

  /friends/requests/{requestId}/accept:
    post:
      tags:
        - å¥½å‹ç®¡ç†
      summary: æ¥å—å¥½å‹é‚€è«‹
      description: æ¥å—æŒ‡å®šçš„å¥½å‹é‚€è«‹
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
          description: å¥½å‹é‚€è«‹ ID
          example: "request_123"
      responses:
        '200':
          description: å¥½å‹é‚€è«‹æ¥å—æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å·²æˆç‚ºå¥½å‹"
                  friend:
                    $ref: '#/components/schemas/Friend'

  /friends/requests/{requestId}/reject:
    post:
      tags:
        - å¥½å‹ç®¡ç†
      summary: æ‹’çµ•å¥½å‹é‚€è«‹
      description: æ‹’çµ•æŒ‡å®šçš„å¥½å‹é‚€è«‹
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
          description: å¥½å‹é‚€è«‹ ID
          example: "request_123"
      responses:
        '200':
          description: å¥½å‹é‚€è«‹æ‹’çµ•æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å¥½å‹é‚€è«‹å·²æ‹’çµ•"

  /friends/requests/{requestId}/withdraw:
    delete:
      tags:
        - å¥½å‹ç®¡ç†
      summary: æ’¤å›å¥½å‹é‚€è«‹
      description: æ’¤å›å·²ç™¼é€çš„å¥½å‹é‚€è«‹
      parameters:
        - name: requestId
          in: path
          required: true
          schema:
            type: string
          description: å¥½å‹é‚€è«‹ ID
          example: "request_123"
      responses:
        '200':
          description: å¥½å‹é‚€è«‹æ’¤å›æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å¥½å‹é‚€è«‹å·²æ’¤å›"

  /friends:
    get:
      tags:
        - å¥½å‹ç®¡ç†
      summary: å–å¾—å¥½å‹åˆ—è¡¨
      description: å–å¾—ä½¿ç”¨è€…çš„å¥½å‹åˆ—è¡¨
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: æœå°‹å¥½å‹åç¨±
          example: "jane"
        - name: group
          in: query
          schema:
            type: string
          description: å¥½å‹åˆ†çµ„ç¯©é¸
          example: "work"
        - name: status
          in: query
          schema:
            type: string
            enum: [online, offline, all]
            default: all
          description: ç·šä¸Šç‹€æ…‹ç¯©é¸
      responses:
        '200':
          description: å¥½å‹åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  friends:
                    type: array
                    items:
                      $ref: '#/components/schemas/Friend'
                  total:
                    type: integer
                    example: 150

  /friends/{friendId}:
    delete:
      tags:
        - å¥½å‹ç®¡ç†
      summary: åˆªé™¤å¥½å‹
      description: å¾å¥½å‹åˆ—è¡¨ä¸­ç§»é™¤æŒ‡å®šå¥½å‹
      parameters:
        - name: friendId
          in: path
          required: true
          schema:
            type: string
          description: å¥½å‹ ID
          example: "user_67890"
      responses:
        '200':
          description: å¥½å‹åˆªé™¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å¥½å‹å·²ç§»é™¤"

  /friends/groups:
    get:
      tags:
        - å¥½å‹ç®¡ç†
      summary: å–å¾—å¥½å‹åˆ†çµ„åˆ—è¡¨
      description: å–å¾—ä½¿ç”¨è€…å»ºç«‹çš„å¥½å‹åˆ†çµ„åˆ—è¡¨
      responses:
        '200':
          description: å¥½å‹åˆ†çµ„åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  groups:
                    type: array
                    items:
                      $ref: '#/components/schemas/FriendGroup'

    post:
      tags:
        - å¥½å‹ç®¡ç†
      summary: å»ºç«‹å¥½å‹åˆ†çµ„
      description: å»ºç«‹æ–°çš„å¥½å‹åˆ†çµ„
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  description: åˆ†çµ„åç¨±
                  minLength: 1
                  maxLength: 50
                  example: "Work Colleagues"
                memberIds:
                  type: array
                  items:
                    type: string
                  description: åˆå§‹æˆå“¡ ID åˆ—è¡¨
                  example: ["user_67890", "user_11111"]
      responses:
        '201':
          description: å¥½å‹åˆ†çµ„å»ºç«‹æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å¥½å‹åˆ†çµ„å»ºç«‹æˆåŠŸ"
                  group:
                    $ref: '#/components/schemas/FriendGroup'

  /friends/qr-code:
    get:
      tags:
        - å¥½å‹ç®¡ç†
      summary: ç”Ÿæˆ QR Code
      description: ç”Ÿæˆç”¨æ–¼æ–°å¢å¥½å‹çš„ QR Code
      responses:
        '200':
          description: QR Code ç”ŸæˆæˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  qrCode:
                    type: string
                    description: QR Code åœ–ç‰‡çš„ Base64 ç·¨ç¢¼
                    example: "data:image/png;base64,iVBORw0KGgoAAAANS..."
                  qrData:
                    type: string
                    description: QR Code åŒ…å«çš„è³‡æ–™
                    example: "messenger://friend/user_12345"
                  expiresAt:
                    type: string
                    format: date-time
                    description: QR Code éæœŸæ™‚é–“
                    example: "2024-01-01T12:00:00Z"

  # ==================== å³æ™‚è¨Šæ¯ ====================
  /conversations:
    get:
      tags:
        - å³æ™‚è¨Šæ¯
      summary: å–å¾—å°è©±åˆ—è¡¨
      description: å–å¾—ä½¿ç”¨è€…çš„æ‰€æœ‰å°è©±åˆ—è¡¨
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: æ¯é ç­†æ•¸
        - name: offset
          in: query
          schema:
            type: integer
            minimum: 0
            default: 0
          description: åç§»é‡
      responses:
        '200':
          description: å°è©±åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  conversations:
                    type: array
                    items:
                      $ref: '#/components/schemas/Conversation'
                  total:
                    type: integer
                    example: 25

  /conversations/{conversationId}/messages:
    get:
      tags:
        - å³æ™‚è¨Šæ¯
      summary: å–å¾—å°è©±è¨Šæ¯
      description: å–å¾—æŒ‡å®šå°è©±çš„è¨Šæ¯åˆ—è¡¨
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
          description: å°è©± ID
          example: "conv_123"
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: æ¯é ç­†æ•¸
        - name: before
          in: query
          schema:
            type: string
          description: å–å¾—æŒ‡å®šè¨Šæ¯ ID ä¹‹å‰çš„è¨Šæ¯ï¼ˆç”¨æ–¼è¼‰å…¥æ›´å¤šæ­·å²è¨Šæ¯ï¼‰
          example: "msg_456"
        - name: search
          in: query
          schema:
            type: string
          description: æœå°‹é—œéµå­—
          example: "meeting"
      responses:
        '200':
          description: è¨Šæ¯åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'
                  hasMore:
                    type: boolean
                    example: true

    post:
      tags:
        - å³æ™‚è¨Šæ¯
      summary: ç™¼é€è¨Šæ¯
      description: å‘æŒ‡å®šå°è©±ç™¼é€è¨Šæ¯
      parameters:
        - name: conversationId
          in: path
          required: true
          schema:
            type: string
          description: å°è©± ID
          example: "conv_123"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - type
                - content
              properties:
                type:
                  type: string
                  enum: [text, image, file, voice]
                  description: è¨Šæ¯é¡å‹
                  example: "text"
                content:
                  type: string
                  description: è¨Šæ¯å…§å®¹
                  maxLength: 2000
                  example: "Hello Jane!"
                mediaUrl:
                  type: string
                  description: åª’é«”æª”æ¡ˆ URLï¼ˆåœ–ç‰‡ã€æª”æ¡ˆã€èªéŸ³è¨Šæ¯ï¼‰
                  example: "https://cdn.messenger-lite.com/media/12345.jpg"
                replyToMessageId:
                  type: string
                  description: å›è¦†çš„è¨Šæ¯ IDï¼ˆé¸å¡«ï¼‰
                  example: "msg_789"
      responses:
        '201':
          description: è¨Šæ¯ç™¼é€æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    $ref: '#/components/schemas/Message'

  /messages/{messageId}:
    put:
      tags:
        - å³æ™‚è¨Šæ¯
      summary: ç·¨è¼¯è¨Šæ¯
      description: ç·¨è¼¯å·²ç™¼é€çš„è¨Šæ¯ï¼ˆ5åˆ†é˜å…§ï¼‰
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
          description: è¨Šæ¯ ID
          example: "msg_123"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - content
              properties:
                content:
                  type: string
                  description: æ–°çš„è¨Šæ¯å…§å®¹
                  maxLength: 2000
                  example: "Hello Jane, how are you?"
      responses:
        '200':
          description: è¨Šæ¯ç·¨è¼¯æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    $ref: '#/components/schemas/Message'

    delete:
      tags:
        - å³æ™‚è¨Šæ¯
      summary: åˆªé™¤è¨Šæ¯
      description: åˆªé™¤è‡ªå·±ç™¼é€çš„è¨Šæ¯
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
          description: è¨Šæ¯ ID
          example: "msg_123"
      responses:
        '200':
          description: è¨Šæ¯åˆªé™¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "è¨Šæ¯å·²åˆªé™¤"

  /messages/{messageId}/read:
    post:
      tags:
        - å³æ™‚è¨Šæ¯
      summary: æ¨™è¨˜è¨Šæ¯ç‚ºå·²è®€
      description: æ¨™è¨˜æŒ‡å®šè¨Šæ¯ç‚ºå·²è®€ç‹€æ…‹
      parameters:
        - name: messageId
          in: path
          required: true
          schema:
            type: string
          description: è¨Šæ¯ ID
          example: "msg_123"
      responses:
        '200':
          description: è¨Šæ¯æ¨™è¨˜ç‚ºå·²è®€æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "è¨Šæ¯å·²æ¨™è¨˜ç‚ºå·²è®€"

  # ==================== ç¾¤çµ„èŠå¤© ====================
  /groups:
    get:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: å–å¾—ç¾¤çµ„åˆ—è¡¨
      description: å–å¾—ä½¿ç”¨è€…åƒèˆ‡çš„ç¾¤çµ„åˆ—è¡¨
      responses:
        '200':
          description: ç¾¤çµ„åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  groups:
                    type: array
                    items:
                      $ref: '#/components/schemas/Group'

    post:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: å»ºç«‹ç¾¤çµ„
      description: å»ºç«‹æ–°çš„ç¾¤çµ„èŠå¤©
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - memberIds
              properties:
                name:
                  type: string
                  description: ç¾¤çµ„åç¨±
                  minLength: 1
                  maxLength: 50
                  example: "Team Discussion"
                description:
                  type: string
                  description: ç¾¤çµ„æè¿°
                  maxLength: 200
                  example: "Our project team"
                memberIds:
                  type: array
                  items:
                    type: string
                  description: åˆå§‹æˆå“¡ ID åˆ—è¡¨ï¼ˆä¸åŒ…æ‹¬å‰µå»ºè€…ï¼‰
                  minItems: 2
                  maxItems: 49
                  example: ["user_67890", "user_11111"]
                isPrivate:
                  type: boolean
                  description: æ˜¯å¦ç‚ºç§äººç¾¤çµ„
                  default: false
                  example: false
      responses:
        '201':
          description: ç¾¤çµ„å»ºç«‹æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  group:
                    $ref: '#/components/schemas/Group'

  /groups/{groupId}:
    get:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: å–å¾—ç¾¤çµ„è³‡è¨Š
      description: å–å¾—æŒ‡å®šç¾¤çµ„çš„è©³ç´°è³‡è¨Š
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      responses:
        '200':
          description: ç¾¤çµ„è³‡è¨Š
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Group'

    put:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: æ›´æ–°ç¾¤çµ„è³‡è¨Š
      description: æ›´æ–°ç¾¤çµ„åç¨±ã€æè¿°ç­‰è³‡è¨Šï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: ç¾¤çµ„åç¨±
                  minLength: 1
                  maxLength: 50
                  example: "Project Alpha Team"
                description:
                  type: string
                  description: ç¾¤çµ„æè¿°
                  maxLength: 200
                  example: "Alpha project development team"
                isPrivate:
                  type: boolean
                  description: æ˜¯å¦ç‚ºç§äººç¾¤çµ„
                  example: true
      responses:
        '200':
          description: ç¾¤çµ„è³‡è¨Šæ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  group:
                    $ref: '#/components/schemas/Group'

    delete:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: åˆªé™¤ç¾¤çµ„
      description: æ°¸ä¹…åˆªé™¤ç¾¤çµ„ï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      responses:
        '200':
          description: ç¾¤çµ„åˆªé™¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "ç¾¤çµ„å·²åˆªé™¤"

  /groups/{groupId}/members:
    get:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: å–å¾—ç¾¤çµ„æˆå“¡åˆ—è¡¨
      description: å–å¾—æŒ‡å®šç¾¤çµ„çš„æˆå“¡åˆ—è¡¨
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      responses:
        '200':
          description: ç¾¤çµ„æˆå“¡åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  members:
                    type: array
                    items:
                      $ref: '#/components/schemas/GroupMember'

    post:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: æ–°å¢ç¾¤çµ„æˆå“¡
      description: æ–°å¢æˆå“¡è‡³ç¾¤çµ„ï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - memberIds
              properties:
                memberIds:
                  type: array
                  items:
                    type: string
                  description: è¦æ–°å¢çš„æˆå“¡ ID åˆ—è¡¨
                  example: ["user_22222"]
      responses:
        '200':
          description: æˆå“¡æ–°å¢æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "æˆå“¡å·²æ–°å¢è‡³ç¾¤çµ„"

  /groups/{groupId}/members/{memberId}:
    delete:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: ç§»é™¤ç¾¤çµ„æˆå“¡
      description: å¾ç¾¤çµ„ä¸­ç§»é™¤æŒ‡å®šæˆå“¡ï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
        - name: memberId
          in: path
          required: true
          schema:
            type: string
          description: æˆå“¡ ID
          example: "user_67890"
      responses:
        '200':
          description: æˆå“¡ç§»é™¤æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "æˆå“¡å·²å¾ç¾¤çµ„ä¸­ç§»é™¤"

  /groups/{groupId}/members/{memberId}/promote:
    post:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: æå‡æˆå“¡ç‚ºç®¡ç†å“¡
      description: å°‡ç¾¤çµ„æˆå“¡æå‡ç‚ºç®¡ç†å“¡ï¼ˆåƒ…ç®¡ç†å“¡ï¼‰
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
        - name: memberId
          in: path
          required: true
          schema:
            type: string
          description: æˆå“¡ ID
          example: "user_67890"
      responses:
        '200':
          description: æˆå“¡æå‡æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "æˆå“¡å·²æå‡ç‚ºç®¡ç†å“¡"

  /groups/{groupId}/leave:
    post:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: é›¢é–‹ç¾¤çµ„
      description: ä¸»å‹•é›¢é–‹ç¾¤çµ„
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      responses:
        '200':
          description: æˆåŠŸé›¢é–‹ç¾¤çµ„
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "å·²é›¢é–‹ç¾¤çµ„"

  /groups/{groupId}/messages:
    get:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: å–å¾—ç¾¤çµ„è¨Šæ¯
      description: å–å¾—æŒ‡å®šç¾¤çµ„çš„è¨Šæ¯åˆ—è¡¨
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 50
          description: æ¯é ç­†æ•¸
        - name: before
          in: query
          schema:
            type: string
          description: å–å¾—æŒ‡å®šè¨Šæ¯ ID ä¹‹å‰çš„è¨Šæ¯
          example: "msg_456"
      responses:
        '200':
          description: ç¾¤çµ„è¨Šæ¯åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  messages:
                    type: array
                    items:
                      $ref: '#/components/schemas/Message'

    post:
      tags:
        - ç¾¤çµ„èŠå¤©
      summary: ç™¼é€ç¾¤çµ„è¨Šæ¯
      description: å‘ç¾¤çµ„ç™¼é€è¨Šæ¯
      parameters:
        - name: groupId
          in: path
          required: true
          schema:
            type: string
          description: ç¾¤çµ„ ID
          example: "group_123"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - type
                - content
              properties:
                type:
                  type: string
                  enum: [text, image, file, voice]
                  description: è¨Šæ¯é¡å‹
                  example: "text"
                content:
                  type: string
                  description: è¨Šæ¯å…§å®¹
                  maxLength: 2000
                  example: "Hello everyone!"
                mediaUrl:
                  type: string
                  description: åª’é«”æª”æ¡ˆ URL
                  example: "https://cdn.messenger-lite.com/media/12345.jpg"
                mentions:
                  type: array
                  items:
                    type: string
                  description: æåŠçš„ä½¿ç”¨è€… ID åˆ—è¡¨
                  example: ["user_67890"]
                replyToMessageId:
                  type: string
                  description: å›è¦†çš„è¨Šæ¯ ID
                  example: "msg_789"
      responses:
        '201':
          description: ç¾¤çµ„è¨Šæ¯ç™¼é€æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    $ref: '#/components/schemas/Message'

  # ==================== é€šçŸ¥ç³»çµ± ====================
  /notifications:
    get:
      tags:
        - é€šçŸ¥ç³»çµ±
      summary: å–å¾—é€šçŸ¥åˆ—è¡¨
      description: å–å¾—ä½¿ç”¨è€…çš„é€šçŸ¥åˆ—è¡¨
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
          description: æ¯é ç­†æ•¸
        - name: unreadOnly
          in: query
          schema:
            type: boolean
            default: false
          description: åƒ…é¡¯ç¤ºæœªè®€é€šçŸ¥
      responses:
        '200':
          description: é€šçŸ¥åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  notifications:
                    type: array
                    items:
                      $ref: '#/components/schemas/Notification'
                  unreadCount:
                    type: integer
                    example: 5

  /notifications/{notificationId}/read:
    post:
      tags:
        - é€šçŸ¥ç³»çµ±
      summary: æ¨™è¨˜é€šçŸ¥ç‚ºå·²è®€
      description: å°‡æŒ‡å®šé€šçŸ¥æ¨™è¨˜ç‚ºå·²è®€
      parameters:
        - name: notificationId
          in: path
          required: true
          schema:
            type: string
          description: é€šçŸ¥ ID
          example: "notif_123"
      responses:
        '200':
          description: é€šçŸ¥å·²æ¨™è¨˜ç‚ºå·²è®€
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "é€šçŸ¥å·²æ¨™è¨˜ç‚ºå·²è®€"

  /notifications/read-all:
    post:
      tags:
        - é€šçŸ¥ç³»çµ±
      summary: æ¨™è¨˜æ‰€æœ‰é€šçŸ¥ç‚ºå·²è®€
      description: å°‡æ‰€æœ‰æœªè®€é€šçŸ¥æ¨™è¨˜ç‚ºå·²è®€
      responses:
        '200':
          description: æ‰€æœ‰é€šçŸ¥å·²æ¨™è¨˜ç‚ºå·²è®€
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "æ‰€æœ‰é€šçŸ¥å·²æ¨™è¨˜ç‚ºå·²è®€"

  /notifications/settings:
    get:
      tags:
        - é€šçŸ¥ç³»çµ±
      summary: å–å¾—é€šçŸ¥è¨­å®š
      description: å–å¾—ä½¿ç”¨è€…çš„é€šçŸ¥è¨­å®š
      responses:
        '200':
          description: é€šçŸ¥è¨­å®š
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationSettings'

    put:
      tags:
        - é€šçŸ¥ç³»çµ±
      summary: æ›´æ–°é€šçŸ¥è¨­å®š
      description: æ›´æ–°ä½¿ç”¨è€…çš„é€šçŸ¥è¨­å®š
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                pushEnabled:
                  type: boolean
                  description: æ¨æ’­é€šçŸ¥é–‹é—œ
                  example: true
                soundEnabled:
                  type: boolean
                  description: è²éŸ³æé†’é–‹é—œ
                  example: true
                vibrationEnabled:
                  type: boolean
                  description: éœ‡å‹•æé†’é–‹é—œ
                  example: true
                doNotDisturb:
                  type: object
                  description: å‹¿æ‰“æ“¾è¨­å®š
                  properties:
                    enabled:
                      type: boolean
                      example: false
                    startTime:
                      type: string
                      format: time
                      description: å‹¿æ‰“æ“¾é–‹å§‹æ™‚é–“
                      example: "22:00"
                    endTime:
                      type: string
                      format: time
                      description: å‹¿æ‰“æ“¾çµæŸæ™‚é–“
                      example: "08:00"
                importantContacts:
                  type: array
                  items:
                    type: string
                  description: é‡è¦è¯çµ¡äºº ID åˆ—è¡¨
                  example: ["user_67890"]
      responses:
        '200':
          description: é€šçŸ¥è¨­å®šæ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "é€šçŸ¥è¨­å®šæ›´æ–°æˆåŠŸ"
                  settings:
                    $ref: '#/components/schemas/NotificationSettings'

  # ==================== ç·šä¸Šç‹€æ…‹èˆ‡éš±ç§ ====================
  /status:
    get:
      tags:
        - ç·šä¸Šç‹€æ…‹èˆ‡éš±ç§
      summary: å–å¾—ç›®å‰ç‹€æ…‹
      description: å–å¾—ä½¿ç”¨è€…ç›®å‰çš„ç·šä¸Šç‹€æ…‹
      responses:
        '200':
          description: ä½¿ç”¨è€…ç·šä¸Šç‹€æ…‹
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserStatus'

    put:
      tags:
        - ç·šä¸Šç‹€æ…‹èˆ‡éš±ç§
      summary: æ›´æ–°ç·šä¸Šç‹€æ…‹
      description: æ›´æ–°ä½¿ç”¨è€…çš„ç·šä¸Šç‹€æ…‹
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [online, busy, away, invisible, offline]
                  description: ç·šä¸Šç‹€æ…‹
                  example: "busy"
                customMessage:
                  type: string
                  description: è‡ªè¨‚ç‹€æ…‹è¨Šæ¯
                  maxLength: 100
                  example: "In a meeting until 3 PM"
      responses:
        '200':
          description: ç·šä¸Šç‹€æ…‹æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "ç·šä¸Šç‹€æ…‹æ›´æ–°æˆåŠŸ"
                  status:
                    $ref: '#/components/schemas/UserStatus'

  /privacy:
    get:
      tags:
        - ç·šä¸Šç‹€æ…‹èˆ‡éš±ç§
      summary: å–å¾—éš±ç§è¨­å®š
      description: å–å¾—ä½¿ç”¨è€…çš„éš±ç§è¨­å®š
      responses:
        '200':
          description: éš±ç§è¨­å®š
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PrivacySettings'

    put:
      tags:
        - ç·šä¸Šç‹€æ…‹èˆ‡éš±ç§
      summary: æ›´æ–°éš±ç§è¨­å®š
      description: æ›´æ–°ä½¿ç”¨è€…çš„éš±ç§è¨­å®š
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                searchPrivacy:
                  type: string
                  enum: [everyone, friends_only, nobody]
                  description: æœå°‹éš±ç§è¨­å®š
                  example: "friends_only"
                messagePrivacy:
                  type: string
                  enum: [everyone, friends_only, contacts_only]
                  description: è¨Šæ¯éš±ç§è¨­å®š
                  example: "friends_only"
                lastSeenPrivacy:
                  type: boolean
                  description: æ˜¯å¦éš±è—æœ€å¾Œä¸Šç·šæ™‚é–“
                  example: false
                readReceiptsEnabled:
                  type: boolean
                  description: æ˜¯å¦é–‹å•Ÿè®€å–å›æ¢
                  example: true
                groupInvitePrivacy:
                  type: string
                  enum: [everyone, friends_only, disabled]
                  description: ç¾¤çµ„é‚€è«‹éš±ç§è¨­å®š
                  example: "friends_only"
                onlineStatusPrivacy:
                  type: string
                  enum: [everyone, friends_only, nobody]
                  description: ç·šä¸Šç‹€æ…‹éš±ç§è¨­å®š
                  example: "friends_only"
      responses:
        '200':
          description: éš±ç§è¨­å®šæ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "éš±ç§è¨­å®šæ›´æ–°æˆåŠŸ"
                  settings:
                    $ref: '#/components/schemas/PrivacySettings'

  # ==================== æª”æ¡ˆä¸Šå‚³ ====================
  /upload/image:
    post:
      tags:
        - æª”æ¡ˆä¸Šå‚³
      summary: ä¸Šå‚³åœ–ç‰‡
      description: ä¸Šå‚³åœ–ç‰‡æª”æ¡ˆï¼ˆJPG, PNG, GIF, æœ€å¤§ 10MBï¼‰
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  format: binary
                  description: åœ–ç‰‡æª”æ¡ˆ
                compress:
                  type: boolean
                  description: æ˜¯å¦è‡ªå‹•å£“ç¸®
                  default: true
      responses:
        '200':
          description: åœ–ç‰‡ä¸Šå‚³æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  url:
                    type: string
                    example: "https://cdn.messenger-lite.com/images/12345.jpg"
                  thumbnail:
                    type: string
                    example: "https://cdn.messenger-lite.com/thumbnails/12345.jpg"
                  size:
                    type: integer
                    description: æª”æ¡ˆå¤§å°ï¼ˆbytesï¼‰
                    example: 2048576

  /upload/file:
    post:
      tags:
        - æª”æ¡ˆä¸Šå‚³
      summary: ä¸Šå‚³æª”æ¡ˆ
      description: ä¸Šå‚³ä¸€èˆ¬æª”æ¡ˆï¼ˆPDF, DOC, TXT ç­‰, æœ€å¤§ 25MBï¼‰
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: æª”æ¡ˆ
      responses:
        '200':
          description: æª”æ¡ˆä¸Šå‚³æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  url:
                    type: string
                    example: "https://cdn.messenger-lite.com/files/document.pdf"
                  filename:
                    type: string
                    example: "document.pdf"
                  size:
                    type: integer
                    description: æª”æ¡ˆå¤§å°ï¼ˆbytesï¼‰
                    example: 5242880
                  mimeType:
                    type: string
                    example: "application/pdf"

  /upload/voice:
    post:
      tags:
        - æª”æ¡ˆä¸Šå‚³
      summary: ä¸Šå‚³èªéŸ³è¨Šæ¯
      description: ä¸Šå‚³èªéŸ³è¨Šæ¯æª”æ¡ˆï¼ˆæœ€é•· 60 ç§’ï¼‰
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - voice
              properties:
                voice:
                  type: string
                  format: binary
                  description: èªéŸ³æª”æ¡ˆ
                duration:
                  type: integer
                  description: èªéŸ³é•·åº¦ï¼ˆç§’ï¼‰
                  maximum: 60
                  example: 30
      responses:
        '200':
          description: èªéŸ³è¨Šæ¯ä¸Šå‚³æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  url:
                    type: string
                    example: "https://cdn.messenger-lite.com/voice/12345.m4a"
                  duration:
                    type: integer
                    description: èªéŸ³é•·åº¦ï¼ˆç§’ï¼‰
                    example: 30
                  size:
                    type: integer
                    description: æª”æ¡ˆå¤§å°ï¼ˆbytesï¼‰
                    example: 524288

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT Token èªè­‰

  schemas:
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: string
          description: éŒ¯èª¤è¨Šæ¯
          example: "Invalid credentials"
        code:
          type: string
          description: éŒ¯èª¤ä»£ç¢¼
          example: "AUTH_ERROR"

    UserProfile:
      type: object
      properties:
        id:
          type: string
          example: "user_12345"
        username:
          type: string
          example: "john_doe"
        displayName:
          type: string
          example: "John Doe"
        email:
          type: string
          format: email
          example: "john@example.com"
        phoneNumber:
          type: string
          example: "+1234567890"
        avatarUrl:
          type: string
          example: "https://cdn.messenger-lite.com/avatars/user_12345.jpg"
        statusMessage:
          type: string
          example: "Busy at work"
        isVerified:
          type: boolean
          example: true
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"
        lastSeenAt:
          type: string
          format: date-time
          example: "2024-01-01T12:00:00Z"

    PrivacySettings:
      type: object
      properties:
        searchPrivacy:
          type: string
          enum: [everyone, friends_only, nobody]
          example: "friends_only"
        messagePrivacy:
          type: string
          enum: [everyone, friends_only, contacts_only]
          example: "friends_only"
        lastSeenPrivacy:
          type: boolean
          example: false
        readReceiptsEnabled:
          type: boolean
          example: true
        groupInvitePrivacy:
          type: string
          enum: [everyone, friends_only, disabled]
          example: "friends_only"
        onlineStatusPrivacy:
          type: string
          enum: [everyone, friends_only, nobody]
          example: "friends_only"

    UserSearchResult:
      type: object
      properties:
        id:
          type: string
          example: "user_67890"
        username:
          type: string
          example: "jane_doe"
        displayName:
          type: string
          example: "Jane Doe"
        avatarUrl:
          type: string
          example: "https://cdn.messenger-lite.com/avatars/user_67890.jpg"
        isFriend:
          type: boolean
          example: false
        hasPendingRequest:
          type: boolean
          example: false

    FriendRequest:
      type: object
      properties:
        id:
          type: string
          example: "request_123"
        fromUser:
          $ref: '#/components/schemas/UserSearchResult'
        toUser:
          $ref: '#/components/schemas/UserSearchResult'
        message:
          type: string
          example: "Hi, let's be friends!"
        status:
          type: string
          enum: [pending, accepted, rejected, expired]
          example: "pending"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"
        expiresAt:
          type: string
          format: date-time
          example: "2024-01-31T00:00:00Z"

    Friend:
      type: object
      properties:
        id:
          type: string
          example: "user_67890"
        username:
          type: string
          example: "jane_doe"
        displayName:
          type: string
          example: "Jane Doe"
        avatarUrl:
          type: string
          example: "https://cdn.messenger-lite.com/avatars/user_67890.jpg"
        status:
          $ref: '#/components/schemas/UserStatus'
        groups:
          type: array
          items:
            type: string
          example: ["work", "university"]
        friendsSince:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"

    FriendGroup:
      type: object
      properties:
        id:
          type: string
          example: "group_friends_123"
        name:
          type: string
          example: "Work Colleagues"
        memberCount:
          type: integer
          example: 5
        members:
          type: array
          items:
            $ref: '#/components/schemas/Friend'
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"

    Conversation:
      type: object
      properties:
        id:
          type: string
          example: "conv_123"
        type:
          type: string
          enum: [direct, group]
          example: "direct"
        participant:
          $ref: '#/components/schemas/Friend'
        lastMessage:
          $ref: '#/components/schemas/Message'
        unreadCount:
          type: integer
          example: 3
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-01T12:00:00Z"

    Message:
      type: object
      properties:
        id:
          type: string
          example: "msg_123"
        conversationId:
          type: string
          example: "conv_123"
        senderId:
          type: string
          example: "user_12345"
        sender:
          $ref: '#/components/schemas/UserSearchResult'
        type:
          type: string
          enum: [text, image, file, voice, system]
          example: "text"
        content:
          type: string
          example: "Hello Jane!"
        mediaUrl:
          type: string
          example: "https://cdn.messenger-lite.com/media/12345.jpg"
        metadata:
          type: object
          description: è¨Šæ¯å…ƒè³‡æ–™ï¼ˆæª”æ¡ˆåç¨±ã€å¤§å°ã€èªéŸ³é•·åº¦ç­‰ï¼‰
          properties:
            filename:
              type: string
              example: "document.pdf"
            fileSize:
              type: integer
              example: 1024000
            duration:
              type: integer
              description: èªéŸ³é•·åº¦ï¼ˆç§’ï¼‰
              example: 30
        replyTo:
          $ref: '#/components/schemas/Message'
        mentions:
          type: array
          items:
            type: string
          example: ["user_67890"]
        status:
          type: string
          enum: [sending, sent, delivered, read, failed]
          example: "read"
        isEdited:
          type: boolean
          example: false
        isDeleted:
          type: boolean
          example: false
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T12:00:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-01T12:05:00Z"

    Group:
      type: object
      properties:
        id:
          type: string
          example: "group_123"
        name:
          type: string
          example: "Team Discussion"
        description:
          type: string
          example: "Our project team"
        avatarUrl:
          type: string
          example: "https://cdn.messenger-lite.com/groups/group_123.jpg"
        memberCount:
          type: integer
          example: 5
        maxMembers:
          type: integer
          example: 50
        isPrivate:
          type: boolean
          example: false
        createdBy:
          type: string
          example: "user_12345"
        admins:
          type: array
          items:
            type: string
          example: ["user_12345", "user_67890"]
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"

    GroupMember:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/UserSearchResult'
        role:
          type: string
          enum: [admin, member]
          example: "member"
        joinedAt:
          type: string
          format: date-time
          example: "2024-01-01T00:00:00Z"
        status:
          $ref: '#/components/schemas/UserStatus'

    Notification:
      type: object
      properties:
        id:
          type: string
          example: "notif_123"
        type:
          type: string
          enum: [message, friend_request, group_invite, system]
          example: "message"
        title:
          type: string
          example: "æ–°è¨Šæ¯"
        body:
          type: string
          example: "Jane Doe: Hello John!"
        data:
          type: object
          description: é€šçŸ¥ç›¸é—œè³‡æ–™
          properties:
            conversationId:
              type: string
              example: "conv_123"
            messageId:
              type: string
              example: "msg_456"
            senderId:
              type: string
              example: "user_67890"
        isRead:
          type: boolean
          example: false
        createdAt:
          type: string
          format: date-time
          example: "2024-01-01T12:00:00Z"

    NotificationSettings:
      type: object
      properties:
        pushEnabled:
          type: boolean
          example: true
        soundEnabled:
          type: boolean
          example: true
        vibrationEnabled:
          type: boolean
          example: true
        doNotDisturb:
          type: object
          properties:
            enabled:
              type: boolean
              example: false
            startTime:
              type: string
              format: time
              example: "22:00"
            endTime:
              type: string
              format: time
              example: "08:00"
        importantContacts:
          type: array
          items:
            type: string
          example: ["user_67890"]
        contactSettings:
          type: object
          description: å€‹åˆ¥è¯çµ¡äººé€šçŸ¥è¨­å®š
          additionalProperties:
            type: object
            properties:
              enabled:
                type: boolean
                example: true
              soundOnly:
                type: boolean
                example: false
              muted:
                type: boolean
                example: false

    UserStatus:
      type: object
      properties:
        status:
          type: string
          enum: [online, busy, away, invisible, offline]
          example: "online"
        customMessage:
          type: string
          example: "In a meeting until 3 PM"
        lastSeenAt:
          type: string
          format: date-time
          example: "2024-01-01T12:00:00Z"
        isOnline:
          type: boolean
          example: true